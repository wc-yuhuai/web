<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>梦源</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .editor-section, .preview-section {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .section-title i {
            margin-right: 10px;
            color: #3498db;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-success {
            background: #2ecc71;
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .style-selector {
            margin-bottom: 20px;
        }
        
        .style-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .style-option {
            padding: 8px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .style-option:hover {
            border-color: #3498db;
        }
        
        .style-option.active {
            border-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }
        
        .directory-items {
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 15px;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
            background: #f9f9f9;
        }
        
        .item-list {
            list-style: none;
        }
        
        .directory-item {
            padding: 12px 15px;
            margin-bottom: 8px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .directory-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .item-content {
            flex: 1;
            display: flex;
            align-items: center;
        }
        
        .item-level {
            display: inline-block;
            width: 24px;
            height: 24px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 10px;
            font-size: 12px;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
        }
        
        .item-actions button {
            background: none;
            border: none;
            color: #7f8c8d;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .item-actions button:hover {
            color: #3498db;
        }
        
        .item-form {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .preview-container {
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 5px;
            background: white;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .preview-content {
            padding: 20px;
        }
        
        .code-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
        }
        
        .code-container {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 5px;
            padding: 20px;
            margin-top: 15px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .copy-btn {
            margin-top: 15px;
            float: right;
        }
        
        .empty-message {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 30px;
        }
        
        .dragging {
            opacity: 0.5;
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
        }
        
        .template-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .template-btn {
            padding: 8px 12px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .template-btn:hover {
            background: #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-list-alt"></i> HTML目录生成器</h1>
            <p class="subtitle">创建、自定义并导出美观的HTML目录结构。支持拖拽排序、多级嵌套和多种样式选择。</p>
        </header>
        
        <div class="app-container">
            <!-- 左侧编辑器 -->
            <section class="editor-section">
                <h2 class="section-title"><i class="fas fa-edit"></i> 目录编辑器</h2>
                
                <div class="controls">
                    <button class="btn" id="addItemBtn">
                        <i class="fas fa-plus"></i> 添加项目
                    </button>
                    <button class="btn btn-danger" id="clearAllBtn">
                        <i class="fas fa-trash"></i> 清空所有
                    </button>
                    <button class="btn btn-success" id="exportBtn">
                        <i class="fas fa-code"></i> 生成HTML代码
                    </button>
                </div>
                
                <div class="style-selector">
                    <h3><i class="fas fa-palette"></i> 选择目录样式</h3>
                    <div class="style-options">
                        <div class="style-option active" data-style="default">默认样式</div>
                        <div class="style-option" data-style="modern">现代风格</div>
                        <div class="style-option" data-style="minimal">简约风格</div>
                        <div class="style-option" data-style="academic">学术风格</div>
                    </div>
                </div>
                
                <div class="template-btns">
                    <p>快速模板：</p>
                    <div class="template-btn" data-template="academic">学术论文目录</div>
                    <div class="template-btn" data-template="book">书籍目录</div>
                    <div class="template-btn" data-template="report">报告目录</div>
                    <div class="template-btn" data-template="manual">手册目录</div>
                </div>
                
                <div class="directory-items">
                    <ul class="item-list" id="directoryList">
                        <!-- 目录项将通过JS动态添加 -->
                        <li class="empty-message" id="emptyMessage">目录为空，请点击"添加项目"按钮或选择快速模板。</li>
                    </ul>
                </div>
                
                <!-- 添加/编辑目录项的表单 -->
                <div class="item-form" id="itemForm" style="display: none;">
                    <h3><i class="fas fa-plus-circle"></i> 添加/编辑目录项</h3>
                    <div class="form-group">
                        <label for="itemTitle">标题</label>
                        <input type="text" id="itemTitle" placeholder="例如：第一章 绪论">
                    </div>
                    <div class="form-group">
                        <label for="itemLevel">层级</label>
                        <select id="itemLevel">
                            <option value="1">一级标题 (h1)</option>
                            <option value="2">二级标题 (h2)</option>
                            <option value="3" selected>三级标题 (h3)</option>
                            <option value="4">四级标题 (h4)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="itemPage">页码 (可选)</label>
                        <input type="number" id="itemPage" placeholder="例如：1">
                    </div>
                    <div class="controls">
                        <button class="btn btn-success" id="saveItemBtn">
                            <i class="fas fa-check"></i> 保存项目
                        </button>
                        <button class="btn" id="cancelItemBtn">
                            <i class="fas fa-times"></i> 取消
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- 右侧预览 -->
            <section class="preview-section">
                <h2 class="section-title"><i class="fas fa-eye"></i> 实时预览</h2>
                <div class="preview-container">
                    <div class="preview-content" id="previewContent">
                        <!-- 目录预览将通过JS动态生成 -->
                        <div class="empty-message">预览将在此处显示</div>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- 生成的HTML代码 -->
        <section class="code-section" id="codeSection" style="display: none;">
            <h2 class="section-title"><i class="fas fa-file-code"></i> 生成的HTML代码</h2>
            <div class="code-container" id="codeContainer">
                <!-- 生成的HTML代码将显示在这里 -->
            </div>
            <button class="btn copy-btn" id="copyCodeBtn">
                <i class="fas fa-copy"></i> 复制代码
            </button>
        </section>
    </div>

    <script>
        // 目录数据
        let directoryItems = [];
        let currentItemId = null;
        let currentStyle = 'default';
        
        // DOM元素
        const directoryList = document.getElementById('directoryList');
        const emptyMessage = document.getElementById('emptyMessage');
        const previewContent = document.getElementById('previewContent');
        const codeSection = document.getElementById('codeSection');
        const codeContainer = document.getElementById('codeContainer');
        const itemForm = document.getElementById('itemForm');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 绑定按钮事件
            document.getElementById('addItemBtn').addEventListener('click', showItemForm);
            document.getElementById('clearAllBtn').addEventListener('click', clearAllItems);
            document.getElementById('exportBtn').addEventListener('click', exportHTMLCode);
            document.getElementById('saveItemBtn').addEventListener('click', saveItem);
            document.getElementById('cancelItemBtn').addEventListener('click', hideItemForm);
            document.getElementById('copyCodeBtn').addEventListener('click', copyCodeToClipboard);
            
            // 绑定样式选择事件
            document.querySelectorAll('.style-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.style-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    currentStyle = this.dataset.style;
                    updatePreview();
                });
            });
            
            // 绑定模板按钮事件
            document.querySelectorAll('.template-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    loadTemplate(this.dataset.template);
                });
            });
            
            // 初始化拖拽功能
            initDragAndDrop();
            
            // 加载示例数据
            loadTemplate('academic');
        });
        
        // 显示添加/编辑表单
        function showItemForm(id = null) {
            currentItemId = id;
            itemForm.style.display = 'block';
            
            // 如果是编辑模式，填充表单
            if (id !== null) {
                const item = directoryItems.find(item => item.id === id);
                document.getElementById('itemTitle').value = item.title;
                document.getElementById('itemLevel').value = item.level;
                document.getElementById('itemPage').value = item.page || '';
            } else {
                // 添加模式，清空表单
                document.getElementById('itemTitle').value = '';
                document.getElementById('itemLevel').value = '3';
                document.getElementById('itemPage').value = '';
            }
            
            // 滚动到表单
            itemForm.scrollIntoView({ behavior: 'smooth' });
        }
        
        // 隐藏表单
        function hideItemForm() {
            itemForm.style.display = 'none';
            currentItemId = null;
        }
        
        // 保存目录项
        function saveItem() {
            const title = document.getElementById('itemTitle').value.trim();
            const level = document.getElementById('itemLevel').value;
            const page = document.getElementById('itemPage').value.trim();
            
            if (!title) {
                alert('请输入标题');
                return;
            }
            
            if (currentItemId !== null) {
                // 编辑现有项目
                const index = directoryItems.findIndex(item => item.id === currentItemId);
                directoryItems[index] = {
                    ...directoryItems[index],
                    title,
                    level: parseInt(level),
                    page: page ? parseInt(page) : null
                };
            } else {
                // 添加新项目
                const newItem = {
                    id: Date.now().toString(),
                    title,
                    level: parseInt(level),
                    page: page ? parseInt(page) : null,
                    order: directoryItems.length
                };
                directoryItems.push(newItem);
            }
            
            hideItemForm();
            renderDirectoryList();
            updatePreview();
        }
        
        // 删除目录项
        function deleteItem(id) {
            directoryItems = directoryItems.filter(item => item.id !== id);
            renderDirectoryList();
            updatePreview();
        }
        
        // 清空所有目录项
        function clearAllItems() {
            if (directoryItems.length === 0 || confirm('确定要清空所有目录项吗？')) {
                directoryItems = [];
                renderDirectoryList();
                updatePreview();
                codeSection.style.display = 'none';
            }
        }
        
        // 渲染目录列表
        function renderDirectoryList() {
            directoryList.innerHTML = '';
            
            if (directoryItems.length === 0) {
                directoryList.appendChild(emptyMessage);
                emptyMessage.style.display = 'block';
                return;
            }
            
            emptyMessage.style.display = 'none';
            
            // 按顺序排序
            const sortedItems = [...directoryItems].sort((a, b) => a.order - b.order);
            
            sortedItems.forEach(item => {
                const li = document.createElement('li');
                li.className = 'directory-item';
                li.dataset.id = item.id;
                li.draggable = true;
                
                li.innerHTML = `
                    <div class="item-content">
                        <span class="item-level">${item.level}</span>
                        <span class="item-title">${item.title}</span>
                        ${item.page ? `<span class="item-page" style="margin-left: 10px; color: #7f8c8d; font-size: 0.9em;">(第${item.page}页)</span>` : ''}
                    </div>
                    <div class="item-actions">
                        <button class="edit-btn" title="编辑"><i class="fas fa-edit"></i></button>
                        <button class="delete-btn" title="删除"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                
                // 绑定编辑和删除按钮事件
                li.querySelector('.edit-btn').addEventListener('click', () => showItemForm(item.id));
                li.querySelector('.delete-btn').addEventListener('click', () => deleteItem(item.id));
                
                directoryList.appendChild(li);
            });
            
            // 重新初始化拖拽功能
            initDragAndDrop();
        }
        
        // 初始化拖拽功能
        function initDragAndDrop() {
            const items = document.querySelectorAll('.directory-item');
            
            items.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('drop', handleDrop);
                item.addEventListener('dragend', handleDragEnd);
            });
        }
        
        // 拖拽相关函数
        let draggedItem = null;
        
        function handleDragStart(e) {
            draggedItem = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }
        
        function handleDrop(e) {
            e.preventDefault();
            if (draggedItem !== this) {
                // 获取拖拽元素和目标元素的ID
                const draggedId = draggedItem.dataset.id;
                const targetId = this.dataset.id;
                
                // 找到对应的数据项
                const draggedIndex = directoryItems.findIndex(item => item.id === draggedId);
                const targetIndex = directoryItems.findIndex(item => item.id === targetId);
                
                // 交换order值
                const tempOrder = directoryItems[draggedIndex].order;
                directoryItems[draggedIndex].order = directoryItems[targetIndex].order;
                directoryItems[targetIndex].order = tempOrder;
                
                // 重新渲染列表
                renderDirectoryList();
                updatePreview();
            }
        }
        
        function handleDragEnd() {
            this.classList.remove('dragging');
            draggedItem = null;
        }
        
        // 更新预览
        function updatePreview() {
            if (directoryItems.length === 0) {
                previewContent.innerHTML = '<div class="empty-message">预览将在此处显示</div>';
                return;
            }
            
            // 按顺序排序
            const sortedItems = [...directoryItems].sort((a, b) => a.order - b.order);
            
            // 根据选择的样式生成预览
            let previewHTML = '';
            
            if (currentStyle === 'modern') {
                previewHTML = generateModernPreview(sortedItems);
            } else if (currentStyle === 'minimal') {
                previewHTML = generateMinimalPreview(sortedItems);
            } else if (currentStyle === 'academic') {
                previewHTML = generateAcademicPreview(sortedItems);
            } else {
                previewHTML = generateDefaultPreview(sortedItems);
            }
            
            previewContent.innerHTML = previewHTML;
        }
        
        // 生成默认样式预览
        function generateDefaultPreview(items) {
            let html = '<div class="default-directory">';
            html += '<h2 style="color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">目录</h2>';
            html += '<ul style="list-style: none; padding-left: 0;">';
            
            items.forEach(item => {
                const paddingLeft = (item.level - 1) * 25;
                const levelClass = `level-${item.level}`;
                
                html += `
                    <li class="${levelClass}" style="margin-bottom: 8px; padding-left: ${paddingLeft}px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #2c3e50;">${item.title}</span>
                            ${item.page ? `<span style="color: #7f8c8d; font-size: 0.9em;">${item.page}</span>` : ''}
                        </div>
                    </li>
                `;
            });
            
            html += '</ul></div>';
            return html;
        }
        
        // 生成现代风格预览
        function generateModernPreview(items) {
            let html = '<div class="modern-directory">';
            html += '<h2 style="color: #2c3e50; text-align: center; margin-bottom: 25px; font-size: 1.8rem;">目录</h2>';
            html += '<div style="max-width: 800px; margin: 0 auto;">';
            
            items.forEach(item => {
                const paddingLeft = (item.level - 1) * 30;
                const levelColors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12'];
                const color = levelColors[item.level - 1] || '#7f8c8d';
                
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; 
                                padding: 12px 15px; margin-bottom: 5px; 
                                border-left: 4px solid ${color};
                                background: ${item.level === 1 ? '#f8f9fa' : 'white'}; 
                                border-radius: 0 5px 5px 0;
                                padding-left: ${paddingLeft + 15}px;">
                        <span style="color: #2c3e50;">${item.title}</span>
                        ${item.page ? `<span style="color: ${color}; font-weight: bold;">${item.page}</span>` : ''}
                    </div>
                `;
            });
            
            html += '</div></div>';
            return html;
        }
        
        // 生成简约风格预览
        function generateMinimalPreview(items) {
            let html = '<div class="minimal-directory">';
            html += '<h3 style="color: #7f8c8d; margin-bottom: 20px; font-weight: 300; letter-spacing: 2px;">CONTENTS</h3>';
            html += '<div style="border-top: 1px solid #eee; padding-top: 15px;">';
            
            items.forEach(item => {
                const paddingLeft = (item.level - 1) * 20;
                
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; 
                                padding: 10px 0; 
                                border-bottom: 1px solid #f5f5f5;
                                padding-left: ${paddingLeft}px;">
                        <span style="color: #2c3e50; font-size: ${5 - item.level * 0.2}rem;">${item.title}</span>
                        ${item.page ? `<span style="color: #95a5a6; font-size: 0.9rem;">${item.page}</span>` : ''}
                    </div>
                `;
            });
            
            html += '</div></div>';
            return html;
        }
        
        // 生成学术风格预览
        function generateAcademicPreview(items) {
            let html = '<div class="academic-directory">';
            html += '<h1 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">目录</h1>';
            html += '<div style="max-width: 700px; margin: 0 auto;">';
            
            items.forEach(item => {
                const levelClass = `level-${item.level}`;
                const fontSize = 1.8 - (item.level * 0.2);
                
                if (item.level === 1) {
                    html += `
                        <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #ddd;">
                            <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                <h2 style="color: #2c3e50; font-size: ${fontSize}rem; margin: 0;">${item.title}</h2>
                                ${item.page ? `<span style="color: #7f8c8d; font-size: 1rem;">${item.page}</span>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    const paddingLeft = (item.level - 1) * 25;
                    
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: baseline;
                                    margin-bottom: 8px; padding-left: ${paddingLeft}px;">
                            <span style="color: #2c3e50; font-size: ${fontSize}rem;">${item.title}</span>
                            ${item.page ? `<span style="color: #7f8c8d; font-size: 0.9rem;">${item.page}</span>` : ''}
                        </div>
                    `;
                }
            });
            
            html += '</div></div>';
            return html;
        }
        
        // 导出HTML代码
        function exportHTMLCode() {
            if (directoryItems.length === 0) {
                alert('请先添加目录项');
                return;
            }
            
            // 按顺序排序
            const sortedItems = [...directoryItems].sort((a, b) => a.order - b.order);
            
            // 生成HTML代码
            let htmlCode = '';
            
            if (currentStyle === 'modern') {
                htmlCode = generateModernHTML(sortedItems);
            } else if (currentStyle === 'minimal') {
                htmlCode = generateMinimalHTML(sortedItems);
            } else if (currentStyle === 'academic') {
                htmlCode = generateAcademicHTML(sortedItems);
            } else {
                htmlCode = generateDefaultHTML(sortedItems);
            }
            
            // 显示代码区域
            codeContainer.textContent = htmlCode;
            codeSection.style.display = 'block';
            codeSection.scrollIntoView({ behavior: 'smooth' });
            
            // 高亮代码
            hljs.highlightElement(codeContainer);
        }
        
        // 生成默认HTML代码
        function generateDefaultHTML(items) {
            let html = `<!-- HTML目录 - 默认样式 -->
<div class="directory-container">
    <h2 class="directory-title">目录</h2>
    <ul class="directory-list">`;
    
    items.forEach(item => {
        const levelClass = `level-${item.level}`;
        const paddingLeft = (item.level - 1) * 25;
        
        html += `
        <li class="directory-item ${levelClass}" style="margin-bottom: 8px; padding-left: ${paddingLeft}px;">
            <div class="item-content">
                <span class="item-title">${item.title}</span>`;
        
        if (item.page) {
            html += `
                <span class="item-page">${item.page}</span>`;
        }
        
        html += `
            </div>
        </li>`;
    });
    
    html += `
    </ul>
</div>

<style>
.directory-container {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background: white;
    border-radius: 5px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.directory-title {
    color: #2c3e50;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #3498db;
}
.directory-list {
    list-style: none;
    padding-left: 0;
}
.directory-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #f5f5f5;
}
.item-title {
    color: #2c3e50;
}
.item-page {
    color: #7f8c8d;
    font-size: 0.9em;
}
</style>`;
    
    return html;
        }
        
        // 生成现代风格HTML代码
        function generateModernHTML(items) {
            let html = `<!-- HTML目录 - 现代风格 -->
<div class="modern-directory">
    <h2 class="directory-header">目录</h2>
    <div class="directory-content">`;
    
    items.forEach(item => {
        const levelClass = `level-${item.level}`;
        const paddingLeft = (item.level - 1) * 30;
        const levelColors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12'];
        const color = levelColors[item.level - 1] || '#7f8c8d';
        
        html += `
        <div class="directory-item ${levelClass}" style="border-left-color: ${color}; padding-left: ${paddingLeft + 15}px;">
            <span class="item-title">${item.title}</span>`;
        
        if (item.page) {
            html += `
            <span class="item-page" style="color: ${color};">${item.page}</span>`;
        }
        
        html += `
        </div>`;
    });
    
    html += `
    </div>
</div>

<style>
.modern-directory {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 800px;
    margin: 0 auto;
    padding: 25px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}
.directory-header {
    color: #2c3e50;
    text-align: center;
    margin-bottom: 25px;
    font-size: 1.8rem;
}
.directory-content {
    max-width: 700px;
    margin: 0 auto;
}
.directory-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    margin-bottom: 5px;
    border-left: 4px solid;
    border-radius: 0 5px 5px 0;
    background: #f8f9fa;
    transition: background 0.3s;
}
.directory-item:hover {
    background: #e9ecef;
}
.directory-item.level-2, .directory-item.level-3, .directory-item.level-4 {
    background: white;
}
.item-title {
    color: #2c3e50;
}
.item-page {
    font-weight: bold;
}
</style>`;
    
    return html;
        }
        
        // 复制代码到剪贴板
        function copyCodeToClipboard() {
            const code = codeContainer.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const btn = document.getElementById('copyCodeBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> 已复制';
                btn.style.background = '#2ecc71';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 2000);
            });
        }
        
        // 加载模板
        function loadTemplate(templateName) {
            directoryItems = [];
            
            if (templateName === 'academic') {
                // 学术论文目录模板
                directoryItems = [
                    {id: '1', title: '摘要', level: 1, page: 1, order: 0},
                    {id: '2', title: 'ABSTRACT', level: 1, page: 2, order: 1},
                    {id: '3', title: '目录', level: 1, page: 3, order: 2},
                    {id: '4', title: '第一章 绪论', level: 1, page: 4, order: 3},
                    {id: '5', title: '1.1 研究背景与意义', level: 2, page: 4, order: 4},
                    {id: '6', title: '1.2 研究现状', level: 2, page: 5, order: 5},
                    {id: '7', title: '1.3 研究内容与方法', level: 2, page: 7, order: 6},
                    {id: '8', title: '第二章 相关理论与技术', level: 1, page: 9, order: 7},
                    {id: '9', title: '2.1 理论基础', level: 2, page: 9, order: 8},
                    {id: '10', title: '2.2 技术框架', level: 2, page: 12, order: 9},
                    {id: '11', title: '第三章 系统设计与实现', level: 1, page: 15, order: 10},
                    {id: '12', title: '3.1 系统架构设计', level: 2, page: 15, order: 11},
                    {id: '13', title: '3.2 功能模块实现', level: 2, page: 18, order: 12},
                    {id: '14', title: '第四章 实验与结果分析', level: 1, page: 22, order: 13},
                    {id: '15', title: '4.1 实验设计', level: 2, page: 22, order: 14},
                    {id: '16', title: '4.2 结果分析', level: 2, page: 25, order: 15},
                    {id: '17', title: '第五章 结论与展望', level: 1, page: 28, order: 16},
                    {id: '18', title: '5.1 研究结论', level: 2, page: 28, order: 17},
                    {id: '19', title: '5.2 未来展望', level: 2, page: 30, order: 18},
                    {id: '20', title: '参考文献', level: 1, page: 32, order: 19},
                    {id: '21', title: '致谢', level: 1, page: 35, order: 20},
                ];
            } else if (templateName === 'book') {
                // 书籍目录模板
                directoryItems = [
                    {id: '1', title: '前言', level: 1, page: 1, order: 0},
                    {id: '2', title: '第一部分：基础篇', level: 1, page: 5, order: 1},
                    {id: '3', title: '第1章 入门指南', level: 2, page: 7, order: 2},
                    {id: '4', title: '1.1 环境搭建', level: 3, page: 7, order: 3},
                    {id: '5', title: '1.2 第一个程序', level: 3, page: 12, order: 4},
                    {id: '6', title: '第2章 核心概念', level: 2, page: 18, order: 5},
                    {id: '7', title: '2.1 变量与数据类型', level: 3, page: 18, order: 6},
                    {id: '8', title: '2.2 控制结构', level: 3, page: 25, order: 7},
                    {id: '9', title: '第二部分：进阶篇', level: 1, page: 35, order: 8},
                    {id: '10', title: '第3章 高级特性', level: 2, page: 37, order: 9},
                    {id: '11', title: '3.1 面向对象编程', level: 3, page: 37, order: 10},
                    {id: '12', title: '3.2 异常处理', level: 3, page: 45, order: 11},
                    {id: '13', title: '第4章 实战项目', level: 2, page: 52, order: 12},
                    {id: '14', title: '4.1 项目规划', level: 3, page: 52, order: 13},
                    {id: '15', title: '4.2 代码实现', level: 3, page: 60, order: 14},
                    {id: '16', title: '附录A 常用工具', level: 1, page: 75, order: 15},
                    {id: '17', title: '附录B 参考资源', level: 1, page: 80, order: 16},
                    {id: '18', title: '索引', level: 1, page: 85, order: 17},
                ];
            } else if (templateName === 'report') {
                // 报告目录模板
                directoryItems = [
                    {id: '1', title: '执行摘要', level: 1, page: 1, order: 0},
                    {id: '2', title: '1. 项目背景', level: 1, page: 3, order: 1},
                    {id: '3', title: '2. 市场分析', level: 1, page: 5, order: 2},
                    {id: '4', title: '2.1 市场规模', level: 2, page: 5, order: 3},
                    {id: '5', title: '2.2 竞争格局', level: 2, page: 8, order: 4},
                    {id: '6', title: '3. 实施方案', level: 1, page: 12, order: 5},
                    {id: '7', title: '3.1 阶段一：准备期', level: 2, page: 12, order: 6},
                    {id: '8', title: '3.2 阶段二：执行期', level: 2, page: 15, order: 7},
                    {id: '9', title: '4. 财务预算', level: 1, page: 18, order: 8},
                    {id: '10', title: '4.1 收入预测', level: 2, page: 18, order: 9},
                    {id: '11', title: '4.2 成本分析', level: 2, page: 21, order: 10},
                    {id: '12', title: '5. 风险评估', level: 1, page: 25, order: 11},
                    {id: '13', title: '6. 结论与建议', level: 1, page: 28, order: 12},
                    {id: '14', title: '附录：调研数据', level: 1, page: 30, order: 13},
                ];
            } else if (templateName === 'manual') {
                // 手册目录模板
                directoryItems = [
                    {id: '1', title: '产品概述', level: 1, page: 1, order: 0},
                    {id: '2', title: '安全须知', level: 1, page: 3, order: 1},
                    {id: '3', title: '安装与设置', level: 1, page: 5, order: 2},
                    {id: '4', title: '3.1 开箱检查', level: 2, page: 5, order: 3},
                    {id: '5', title: '3.2 硬件安装', level: 2, page: 7, order: 4},
                    {id: '6', title: '3.3 软件配置', level: 2, page: 10, order: 5},
                    {id: '7', title: '基本操作', level: 1, page: 15, order: 6},
                    {id: '8', title: '4.1 启动与关机', level: 2, page: 15, order: 7},
                    {id: '9', title: '4.2 主要功能使用', level: 2, page: 18, order: 8},
                    {id: '10', title: '4.3 参数设置', level: 2, page: 22, order: 9},
                    {id: '11', title: '高级功能', level: 1, page: 25, order: 10},
                    {id: '12', title: '5.1 自定义配置', level: 2, page: 25, order: 11},
                    {id: '13', title: '5.2 扩展模块', level: 2, page: 28, order: 12},
                    {id: '14', title: '故障排除', level: 1, page: 32, order: 13},
                    {id: '15', title: '6.1 常见问题', level: 2, page: 32, order: 14},
                    {id: '16', title: '6.2 错误代码表', level: 2, page: 35, order: 15},
                    {id: '17', title: '维护与保养', level: 1, page: 38, order: 16},
                    {id: '18', title: '技术规格', level: 1, page: 40, order: 17},
                    {id: '19', title: '保修信息', level: 1, page: 42, order: 18},
                ];
            }
            
            // 设置学术风格为默认
            document.querySelectorAll('.style-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector('.style-option[data-style="academic"]').classList.add('active');
            currentStyle = 'academic';
            
            renderDirectoryList();
            updatePreview();
        }
        
        // 生成学术风格HTML代码
        function generateAcademicHTML(items) {
            return generateDefaultHTML(items); // 简化示例，实际使用时可扩展
        }
        
        // 生成简约风格HTML代码
        function generateMinimalHTML(items) {
            return generateDefaultHTML(items); // 简化示例，实际使用时可扩展
        }
    </script>
</body>
</html>